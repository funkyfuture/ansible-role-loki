---

- name: Set target version complementary to promtail's
  ansible.builtin.set_fact:
    loki_version: "{{ promtail_version }}"
  when: promtail_version is defined

- name: Set source URL base and binary
  ansible.builtin.set_fact:
    # possibly overridden in tasks/local_download.yml
    binaries_location: "https://github.com/grafana/loki/releases/download/v{{ loki_version }}"
    loki_binaries: ["loki"]

- name: Extend binaries with logcli
  ansible.builtin.set_fact:
    loki_binaries: ["loki", "logcli"]
  when: loki_install_logcli

- name: Define a mapping from ansible_architecture to common names
  ansible.builtin.set_fact:
    _architectures:
      aarch64: arm64
      armv6l: arm
      armv7l: arm
      x86_64: amd64

- name: Define binary archive suffix
  ansible.builtin.set_fact:
    loki_binaries_archive_suffix: linux-{{ _architectures[ansible_architecture] }}.zip

...
